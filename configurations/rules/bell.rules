import org.openhab.core.library.types.*
import org.openhab.core.persistence.*
import org.openhab.model.script.actions.*
 
var Timer openTimer = null
var Timer notificationTimer = null

rule "Bell State" 
when
	Item Bell changed
then

	if( Bell.state == OPEN ){

		Bell_Last_Change.postUpdate( now.toString() )

		if( Presence_Garden.state == ON ){
			if(notificationTimer==null) {
				notificationTimer = createTimer(now.plusSeconds(30)) [|
					notificationTimer=null
				]
				pushover("Klingel: Es klingelt")
				sendMail("wir@cyberkov.at","Es klingelt","Es klingelt jemand an der TÃ¼r","https://haus.cyberkov.at/")
			}
		}
	}
end 


