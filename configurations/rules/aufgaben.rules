import org.openhab.core.library.types.*
import org.openhab.core.persistence.*
import org.openhab.model.script.actions.*

// set date on update
rule "Tasks changes"
when
  Item Tasks changed
then
  Tasks_Last_Change.postUpdate( now.toString() )
end

//Task_Toothbrush

rule "Tausche Zahnbuerste vierteljaehrlich"
when
    Time cron "0 0 8 20W MAR,JUN,SEP,DEC ?"   // virteljaehrlich, werktags um den 20. um 8:00
then
    sendCommand(Task_Toothbrush, ON)
end

//Task_Waschmaschine
rule "Waschmaschine ist fertig"
when
    Item UG_Wirtschaftsraum_CCU2_Waschmaschine changed to OFF
then
    logInfo("Task_Waschmaschine", "Waschmaschine ist fertig")
    sendCommand(Task_Waschmaschine, OFF)
    sendCommand(Task_Waesche, ON)
    postUpdate(push_message_text, "Waschmaschine ist fertig.")
end

rule "Waschmaschine wird ausgeschaltet"
when
    Item openhab.UG_Wirtschaftsraum_Waschmaschine_power changed
then
    if ( openhab.UG_Wirtschaftsraum_Waschmaschine_power.state <= 1 and Task_Waesche.state == ON) {
        logInfo("Task Waschmaschine2", "Waschmaschine ausgeschaltet")
        sendCommand(Task_Waesche, ON)
    }
end

//Task_Geschirrspueler
rule "Geschirrspueler ist fertig"
when
    Item EG_Kueche_CCU2_Geschirrspueler changed to OFF
then
    logInfo("Task_Geschirrspueler", "Geschirrspueler ist fertig")
    postUpdate(push_message_text, "Geschirrspueler ist fertig.")
end
